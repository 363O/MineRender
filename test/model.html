<!DOCTYPE html>
<html>
    <head>

        <style>
            body, html {
                overflow-x: hidden;
                overflow-y: hidden;
            }

            body {
                margin: 0;
            }

            canvas {
                width: 100%;
                height: 100%;
            }
        </style>
    </head>
    <body>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/94/three.min.js" integrity="sha256-NGC9JEuTWN4GhTj091wctgjzftr+8WNDmw0H8J5YPYE=" crossorigin="anonymous"></script>
        <script src="../dist/model.js"></script>
        <script>
            (function () {
                let fence = [
                    {
                        model: "block/birch_fence_post",
                        offset: [0, 0, 0]
                    },
                    {
                        model: "block/birch_fence_side",
                        offset: [0, 0, -3]
                    },
                    {
                        model: "block/birch_fence_post",
                        offset: [0, 0, -13]
                    }
                ];

                window.modelRender = new ModelRender({
                    showAxes: true,
                    showGrid: false,
                    showOutlines: false,
                    centerCubes: true,
                    assetRoot: "/res/rp/bdcraft512"
                });

                let multiBlock = [];

                for (let x = 0; x < 8; x++) {
                    for (let z = 0; z < 8; z++) {
                        multiBlock.push({
                            model: (location.hash.substr(1) || "block/stone"),
                            offset: [x * 16, 0, z * 16]
                        })
                    }
                }

                window.modelRender.render(multiBlock, function () {

                });

                // let cancel = false;
                // document.body.addEventListener("modelRender", function () {
                //     if (cancel) {
                //         console.log("cancel!")
                //         cancelAnimationFrame(window.modelRender._animId);
                //     } else if (window.modelRender.models.length > 0) {
                //         console.log("should cancel")
                //         cancel = true;
                //     }
                // })
            })();
        </script>
    </body>
</html>